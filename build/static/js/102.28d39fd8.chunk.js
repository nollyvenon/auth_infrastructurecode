"use strict";(self.webpackChunkavas_auth=self.webpackChunkavas_auth||[]).push([[102],{1314:function(e,n,t){t.d(n,{Z:function(){return c}});var i=t(7313),r=t(5968),o=t(3451),a=t(2704),s=t.n(a),l=t(6417),c=function(e){var n=e.code;return(0,i.useEffect)((function(){new(s())(".copy-button").on("success",(function(e){e.clearSelection(),alert("Code copied to clipboard!")}))}),[]),(0,l.jsxs)("div",{className:"chat-bubble",children:[(0,l.jsx)("div",{className:"code-container",children:(0,l.jsx)(r.Z,{language:"javascript",style:o.Z,showLineNumbers:!0,children:n})}),(0,l.jsx)("button",{className:"copy-button","data-clipboard-text":n,children:"Copy Code"})]})}},8102:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var i=t(7313),r=t(2135),o=t(9860),a=t(9019),s=t(3428),l=t(3405),c=t(9439),u=t(603),d=t(6573),m=t(7829),h=t(4313),f=t(2294),p=t(9099),x=t(8089),v=t(7410),y=t(6417),T=function(){var e=(0,i.useContext)(u.$),n=e.email,t=e.otp,r=e.setPage,o=(0,i.useState)(""),a=(0,c.Z)(o,2),s=a[0],l=a[1],T=(0,i.useState)(!0),P=(0,c.Z)(T,2),g=P[0],C=P[1],j=(0,i.useState)(60),b=(0,c.Z)(j,2),O=b[0],_=b[1];return(0,i.useEffect)((function(){var e=setInterval((function(){_((function(n){return n<=1&&clearInterval(e),n<=1&&C(!1),n-1}))}),1e3);return function(){return clearInterval(e)}}),[g]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(m.Z,{alignItems:"center",display:"flex",mt:2,children:[(0,y.jsx)(h.Z,{sx:{flexGrow:1},orientation:"horizontal"}),(0,y.jsx)(h.Z,{sx:{flexGrow:1},orientation:"horizontal"})]}),(0,y.jsx)(v.J9,{initialValues:{email:"",password:"",submit:null},validationSchema:x.Ry().shape({verify_code:x.Z_().max(255).required("Verification code is required")}),children:function(e){var i=e.errors,o=(e.handleBlur,e.handleChange,e.handleSubmit,e.isSubmitting,e.touched);e.values;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h3",{children:"Email Verification"}),(0,y.jsx)("p",{children:"We have sent a verification code to your email."}),(0,y.jsxs)("form",{children:[(0,y.jsx)(f.Z,{error:Boolean(o.email&&i.email),fullWidth:!0,className:"verification-input",helperText:o.email&&i.email,label:"Verification Code",margin:"normal",name:"verify_code",onBlur:function(e){l(e.target.value)},onChange:function(e){l(e.target.value)},type:"text",value:s,variant:"outlined"}),(0,y.jsx)(m.Z,{mt:2,children:(0,y.jsx)(p.Z,{onClick:function(){parseInt(s)===t?r("reset"):alert("The code you have entered is not correct, try again or re-send the link")},color:"primary",fullWidth:!0,size:"large",type:"submit",variant:"contained",children:"Verify Account"})}),(0,y.jsxs)("a",{color:"primary",className:"resend-otp",onClick:function(){g||d.Z.post("".concat({NODE_ENV:"production",PUBLIC_URL:"http://localhost:3001",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BASE_NAME:"/",REACT_APP_VERSION:"v2.0.0"}.API_URL,"/send_email"),{OTP:t,recipient_email:n}).then((function(){return C(!0)})).then((function(){return alert("A new OTP has succesfully been sent to your email.")})).then((function(){return _(60)})).catch(console.log)},children:[" ","Didn't receive code?",g?"Resend OTP in ".concat(O,"s"):" Resend OTP"]})]})]})}})]})},P=t(4427),g=t(1314),C=function(){var e=(0,o.Z)();return(0,y.jsxs)(a.ZP,{container:!0,justifyContent:"space-evenly",alignItems:"center",sx:{backgroundColor:e.palette.common.black,height:"100%",minHeight:"100vh"},children:[(0,y.jsx)(a.ZP,{item:!0,xs:11,sm:7,md:6,lg:5,children:(0,y.jsx)(s.Z,{sx:{overflow:"visible",display:"flex",position:"relative","& .MuiCardContent-root":{flexGrow:1,flexBasis:"50%",width:"50%"},maxWidth:"475px",margin:"24px auto"},children:(0,y.jsx)(l.Z,{sx:{p:e.spacing(5,4,3,4)},children:(0,y.jsxs)(a.ZP,{container:!0,direction:"column",spacing:4,justifyContent:"center",children:[(0,y.jsx)(a.ZP,{item:!0,xs:12,children:(0,y.jsx)(a.ZP,{container:!0,justifyContent:"space-between",children:(0,y.jsx)(a.ZP,{item:!0,children:(0,y.jsx)(r.rU,{to:"/",children:(0,y.jsx)("img",{alt:"Auth method",src:P})})})})}),(0,y.jsx)(a.ZP,{item:!0,xs:12,children:(0,y.jsx)(T,{})})]})})})}),(0,y.jsx)(a.ZP,{item:!0,xs:11,sm:7,md:6,lg:5,children:(0,y.jsx)(g.Z,{code:'import React, { useState, useEffect } from \'react\';\nimport { useContext } from \'react\';\nimport { RecoveryContext } from \'../../layout/App\';\nimport axios from \'axios\';\n// material-ui\nimport { Box, Button, Divider, TextField } from \'@mui/material\';\n\n//  third party\nimport * as Yup from \'yup\';\nimport { Formik } from \'formik\';\n\n// ==============================|| FIREBASE LOGIN ||============================== //\n\nconst FireOTPInput = ({}) => {\n  const { email, otp, setPage } = useContext(RecoveryContext);\n  const [OTPinput, setOTPinput] = useState(\'\');\n  const [disable, setDisable] = useState(true);\n  const [timerCount, setTimer] = useState(60);\n\n  //function to verify OTP\n  function verifyOTP() {\n    if (parseInt(OTPinput) === otp) {\n      setPage(\'reset\');\n    } else {\n      alert(\'The code you have entered is not correct, try again or re-send the link\');\n    }\n  }\n\n  //function to resend OTP\n  function resendOTP() {\n    if (disable) return;\n    axios\n      .post("{process.env.API_URL}/send_email", {\n        OTP: otp,\n        recipient_email: email\n      })\n      .then(() => setDisable(true))\n      .then(() => alert(\'A new OTP has succesfully been sent to your email.\'))\n      .then(() => setTimer(60))\n      .catch(console.log);\n  }\n  //timer function\n  useEffect(() => {\n    let interval = setInterval(() => {\n      setTimer((lastTimerCount) => {\n        lastTimerCount <= 1 && clearInterval(interval);\n        if (lastTimerCount <= 1) setDisable(false);\n        return lastTimerCount - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [disable]);\n\n  //const { errors } = this.state;\n\n  return (\n    <>\n      <Box alignItems="center" display="flex" mt={2}>\n        <Divider sx={{ flexGrow: 1 }} orientation="horizontal" />\n\n        <Divider sx={{ flexGrow: 1 }} orientation="horizontal" />\n      </Box>\n\n      <Formik\n        initialValues={{\n          email: \'\',\n          password: \'\',\n          submit: null\n        }}\n        validationSchema={Yup.object().shape({\n          verify_code: Yup.string().max(255).required(\'Verification code is required\')\n        })}\n      >\n        {({ errors, handleBlur, handleChange, handleSubmit, isSubmitting, touched, values }) => (\n          <>\n            <h3>Email Verification</h3>\n            <p>We have sent a verification code to your email.</p>\n            <form>\n              <TextField\n                error={Boolean(touched.email && errors.email)}\n                fullWidth\n                className="verification-input"\n                helperText={touched.email && errors.email}\n                label="Verification Code"\n                margin="normal"\n                name="verify_code"\n                onBlur={(e) => {\n                  setOTPinput(e.target.value);\n                }}\n                onChange={(e) => {\n                  setOTPinput(e.target.value);\n                }}\n                type="text"\n                value={OTPinput}\n                variant="outlined"\n              />\n              <Box mt={2}>\n                <Button onClick={() => verifyOTP()} color="primary" fullWidth size="large" type="submit" variant="contained">\n                  Verify Account\n                </Button>\n              </Box>\n\n              <a color="primary" className="resend-otp" onClick={() => resendOTP()}>\n                {\' \'}\n                Didn\'t receive code?\n                {disable ? "Resend OTP in {timerCount}s" : \' Resend OTP\'}\n              </a>\n            </form>\n          </>\n        )}\n      </Formik>\n    </>\n  );\n};\n\nexport default FireOTPInput;\n'})})]})}}}]);